---
title: Authentication
layout: article
---

<div id="toc"></div>

Bridge supports three main authentication methods. Each pathway requires different credentials and different forms of interaction from the user, so you will want to evaluate the approach that is best for your onboarding experience. 

## Email and Password Authentication
For backend system accounts and some studies, users can sign up with an email address and a password they themselves supply. 

While apps have in the past cached these credentials to sign the user back into the system on session expiration, the [reauthentication token](#reauthentication) in the session can now be used to renew the session with no further credentials.

### Email/Password Sign-Up
On sign up for the study, the following steps must be executed:

1. The user signs up for an account, entering an email address and password as part of the [SignUp](/#SignUp) payload and the [sign-up API](/swagger-ui/index.html#!/Authentication/signUp). Your app should verify a password has been entered, otherwise the server will assume this account will be authenticated using the email-only pathway;
2. The server will send an email with a link to verify the email address. This link does **not** need to be intercepted by the app, and the link can be opened in any web browser on any device;

### Email/Password Sign-In
After verifying their email address, the user must manually sign in to the application. They can sign in using their email and password using the [SignIn](/#SignIn) payload and the [sign-in API](/swagger-ui/index.html#!/Authentication/signIn).

See [reauthentication](#reauthentication) below for how to refresh a session once it expires, without user intervention.

**Note:** It is possible to reset the password on an account with no password, and set a password for that account. That account will then be able to sign in with an email and password, if there is any way to do so in your app or another user interface. Be sure not to send this password in sign in attempts where you wish the user to use an email- or phone-only authentication pathway. This is most likely to come up for developers who use the same email address to sign in to our administrative interface, the [Bridge Study Manager,](https://research.sagebridge.org/) as well as a test account in the app under development.

## Email-Only Authentication

Users can authenticate using only their email address. The steps for this form of authentication are as follows:

### Email-Only Sign-Up
On sign up for the study, the following steps must be executed:

1. The user signs up for an account, entering an email address (but no password) as part of the [SignUp](#/SignUp) payload using the [sign-up API](/swagger-ui/index.html#!/Authentication/signUp);
2. The server will send an email with a link to verify the address and sign in to the application;
3. If the user clicks the link on the phone. The link should be captured as a "deep link" by the app. The link contains a query string portion that has three parameters:
    * <code>email</code>&mdash;the user's email address;
    * <code>study</code>&mdash;the study identifier of the study;
    * <code>token</code>&mdash;a string token that must be passed back to the server to authenticate.
4. The app sends this information back to the [email sign in API](/swagger-ui/index.html#!/Authentication/signInViaEmail) using the [EmailSignIn](/#EmailSignIn) playload;
5. If the token is valid and it has been submitted within 5 minutes of being generated by the server, it will verify the email address if it hasn't been verified, and a [UserSessionInfo](/#UserSessionInfo) is returned to the app;

If the user clicks the link on another device, you will need to capture the link on your website with an explanation that the link should be used via email on the phone.

See [reauthentication](#reauthentication) below for how to refresh a session once it expires.

### Email-Only Sign-In
After sign-up, when the user needs to sign-in again due to a session expiration, the app will either need to use the cached email address, or prompt for the email address, to trigger an [email sign-in request](/swagger-ui/index.html#!/Authentication/requestEmailSignIn). This sends an email as described from step #2 above.

## Phone-Only Authentication

**Note: this feature is slated for implementation at the end of 2017.**

Users can authenticate using only their phone number. The steps for this form of authentication are as follows:

### Phone-Only Sign-Up
On sign up for the study, the following steps must be executed:

1. The user signs up for an account, entering a telephone number (but no password) as part of the [SignUp](#/SignUp) payload using the [sign-up API](/swagger-ui/index.html#!/Authentication/signUp);
2. The server will send an SMS messages with a code to enter into your application;
3. The user enters the code. The app must send the following information to the server:
    * <code>phone</code>&mdash;the user's phone number (the user many need to be prompted to enter the phone number, depending on the platform);
    * <code>study</code>&mdash;the study identifier of the study;
    * <code>token</code>&mdash;a string representation of the numeric code sent via SMS that must be passed back to the server to authenticate.
4. The app sends this information back to the [phone sign in API](/swagger-ui/index.html#!/Authentication/signInViaPhone) using the [PhoneSignIn](/#PhoneSignIn) playload;
5. If the token is valid and it has been submitted within 5 minutes of being generated by the server, it will verify the phone number if it hasn't been verified, and a [UserSessionInfo](/#UserSessionInfo) is returned to the app;

See [reauthentication](#reauthentication) below for how to refresh a session once it expires.

### Phone-Only Sign-In
After sign-up, when the user needs to sign-in again due to a session expiration, the app will either need to use the cached phone number, or prompt for the number again, to trigger a [phone sign-in request](/swagger-ui/index.html#!/Authentication/requestPhoneSignIn). This sends an SMS message as described from step #2 above.

## Reauthentication
The [UserSessionInfo](#/UserSessionInfo) payload returned by the sign in process includes a `reauthToken` that can be sent to the [reauthentication endpoint](). The token is a one-time token that will be replaced when it is used to generate a new session for the client (that session includes a new token in order to chain these requests indefinitely). In effect, the `reauthToken` is like an auto-generated password that avoids the need for users to sign in again once we establish their identity. 

As long as the application holds on to this reauthentication token, it will not need to re-involve the user in authentication. If the app loses this token, it will have to sign in again using its preferred authentication channel. In the case of email/password credentials, the app may be able to cache the credentials and sign in again without prompting the user. In the case of email-only and phone-only authentication, the app will need to involve the user.
